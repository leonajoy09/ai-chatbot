{
    ...
    "vnets": [
      {
        "ip_ranges": [
          "{address_space_of_virtual_network}"
        ],
        "network_security_groups": {
          "appgw": {
            "inbound": {
              "AllowGatewayManagerInbound": {
                "priority": 300,
                "description": "Required inbound rule for application gateway",
                "access": "Allow",
                "protocol": "Tcp",
                "source_port_range": "*",
                "destination_port_range": "65200-65535",
                "source_address_prefix": "Internet",
                "destination_address_prefix": "*"
              },
              "AllowAzureLoadBalancerInbound": {
                "priority": 600,
                "description": "Required inbound for application gateway",
                "access": "Allow",
                "protocol": "*",
                "source_port_range": "*",
                "destination_port_range": "*",
                "source_address_prefix": "AzureLoadBalancer",
                "destination_address_prefix": "{address_space_of_agw_subnet}"
              }
            },
            "outbound": {},
            "disable_default_outbound_rules": true
          }
        },
        "default_nsg_extra_rules": {},
        "subnets": {
          "agw": {
            "ip_range": "{address_space_of_agw_subnet}",
            "network_security_group_name": "appgw",
            "service_endpoints": [
              "Microsoft.KeyVault"
            ]
          },
          "pep": {
            "ip_range": "{address_space_of_pep_subnet}"
          },
          ...
        },
        ...
      }
    ]
}
  